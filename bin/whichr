# stolen from the gnuplot gem
# and then modified
require 'rubygems'
require 'sane'

if(ARGV[0].in?( ['-h', '--help'])) || !ARGV[0]
  puts 'syntax: binary_name'
else
  puts 'higher in the list will be executed first'
  def which ( bins )
    success = false
    path = ENV['PATH']
    # on windows add . [cwd]
    path += ('.' + File::PATH_SEPARATOR) if RUBY_PLATFORM =~ /mswin|mingw/

    path.split(File::PATH_SEPARATOR).each do |dir|
      for bin in bins
        candidates = Dir.glob(dir.gsub("\\", "/") + '/' + bin.strip)
        for candidate in candidates
          if File::executable?(candidate)
            print candidate
            if(File.directory?(candidate))
              print ' (is a directory)'
            end
            success = true
            puts
          elsif File::exist? candidate
            puts candidate + ' (is not executable)'
          end
        end
      end
    end

    # This is an implementation that works when the which command is
    # available.
    #
    # IO.popen("which #{bin}") { |io| return io.readline.chomp }
    return success
  end

  list = [ARGV[0]]

  if RUBY_PLATFORM =~ /mswin|mingw/
    # windows compat.
    for extension in  ENV['PATHEXT'].split(';') do
      list << ARGV[0] + extension
    end
  end

  which(list)

end
