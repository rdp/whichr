# stolen from the gnuplot gem
# and then modified
require 'rubygems'
require 'sane'

if(ARGV[0].in?( ['-h', '--help'])) || !ARGV[0]
  puts 'syntax: nameary_name'
else
  puts 'higher in the list will be executed first'
  def which( names )
    success = false
    path = ENV['PATH']
    # on windows add . [cwd]
    path += ('.' + File::PATH_SEPARATOR) if RUBY_PLATFORM =~ /mswin|mingw/

    path.split(File::PATH_SEPARATOR).each do |dir|
      for name in names
        candidates = Dir.glob(dir.gsub("\\", "/") + '/' + name.strip)
        for candidate in candidates
	  # might just match the name and not be executable
	  candidate = Dir.glob(candidate + '*')[0] if RUBY_PLATFORM =~ /mswin|mingw/ # get the right capitalization in doze
          if File::executable?(candidate)
            print candidate
            if(File.directory?(candidate))
              print ' (is a directory)'
            end
            success = true
            puts
          elsif File::exist? candidate
            puts candidate + ' (is not executable)'
          end
        end
      end
    end

    return success
  end

  list = [ARGV[0]]

  if RUBY_PLATFORM =~ /mswin|mingw/
    # windows compat.
    for extension in  ENV['PATHEXT'].split(';') do
      list << ARGV[0] + extension
    end
  end

  which(list)

end
